name: Deploy to Hugging Face Space

on:
  push:
    branches:
      - master   # or main, if your default branch is main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: Install Hugging Face Hub
        run: |
          python -m pip install --upgrade pip
          pip install huggingface_hub

      - name: Upload to Hugging Face Space (Python API)
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          python - << 'EOF'
          from huggingface_hub import HfApi, create_repo

          space_id = "Nirav37/CareQuery"  # <username>/<space name>

          # Make sure the Space exists (no error if it already does)
          create_repo(
              repo_id=space_id,
              repo_type="space",
              exist_ok=True,
              space_sdk="streamlit",   # or "gradio", "docker", etc.
          )

          api = HfApi()
          api.upload_folder(
              folder_path=".",                 # upload entire repo
              repo_id=space_id,
              repo_type="space",
              commit_message="Auto-deploy from GitHub",
          )
          EOF
